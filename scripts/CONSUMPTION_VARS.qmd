---
title: "Consumption indicators"
format: html
editor: visual
---

```{r grappe}

load(here('data', 'grappe_gps.RData'))
```

# Access

```{r access}

load(here('data', 'trade.RData')) 
load(here('data', 'food_price.RData')) 
load(here('data', 'livestock.RData')) 
load(here('data', 'income.RData')) 

access <- left_join(trade %>% select(grappe, sh_imp_rice),
                    food_price %>% st_drop_geometry() %>% 
                      select(grappe, food_prices_avg, food_prices_med),
                    by = 'grappe') %>% 
  left_join(livestock %>% st_drop_geometry() %>% 
              select(grappe, sh_livestock),
            by = 'grappe') %>% 
  left_join(income %>% st_drop_geometry() %>% 
              select(grappe, income),
            by = 'grappe')
            
vis_miss(access)
  
```

# Utilization

```{r utilization}

load(here('data', 'food_safety.RData'))
load(here('data', 'education.RData'))
load(here('data', 'health_facility.RData'))
load(here('data', 'diet.RData'))

utilization <- left_join(food_safety %>%
                           select(grappe, fridge),
                         education %>% st_drop_geometry() %>% 
                           select(grappe, education),
                         by = 'grappe') %>% 
  left_join(health_facility %>% st_drop_geometry() %>% 
              select(grappe, sh_health_facility),
            by = 'grappe') %>% 
  left_join(diet %>% st_drop_geometry() %>% 
              select(grappe, diet_nutritive, diet_diversified),
            by = 'grappe')
  
vis_miss(utilization)

```

```{r consumption}

consumption <- left_join(access, utilization %>% st_drop_geometry(), by = 'grappe')

save(consumption, file = here('data', 'consumption.RData'))

```
