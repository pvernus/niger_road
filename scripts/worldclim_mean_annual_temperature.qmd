---
title: "Mean annual temperature"
format: html
editor: visual
---

**Source**: [Historical monthly weather data --- WorldClim 1 documentation](https://www.worldclim.org/data/monthlywth.html) **Spatial Reference:** WGS 1984

```{r}
load(here('data', 'grappe_gps.RData'))

mean_temp <- terra::rast(here('data_raw', 'leon_data', 'rasters', 'Mean_temp.tif'))

# terra::crs(total_precipitation)

mean_temp_by_grappe <- mean_temp %>% 
  exactextractr::exact_extract(grappe_buffer) %>% 
  rbindlist(idcol = "id") %>% 
  group_by(id) %>% 
  summarize(mean_temp = sum(value * coverage_fraction) / sum(coverage_fraction))

# merge 
mean_temp <- grappe_sf |> 
  rowid_to_column(var = "id") |> 
  left_join(mean_temp_by_grappe, by = "id")

save(mean_temp, file = here('data', 'mean_temp.RData'))
  
```
